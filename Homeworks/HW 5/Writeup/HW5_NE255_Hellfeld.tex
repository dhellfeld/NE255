\documentclass[10pt]{article}
\usepackage[left=0.9in,top=0.9in,bottom=0.9in,right=0.9in]{geometry}
\usepackage[english]{babel}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{caption}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{float}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{soul}
\usepackage{enumerate}
\usepackage{wrapfig}
\usepackage{listings}
\usepackage{diagbox}

% Listings settings
\lstset{frame=tb,
  language=Python,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\scriptsize\ttfamily},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3,
  numbers=left,
  xleftmargin=4em,
  framexleftmargin=3.5em
}

% Remove bibliography title
\usepackage{etoolbox}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}

% Set up header/footers
\pagestyle{fancy}
\fancyhead[LE,RO]{\today}
\fancyhead[C]{NE 255 - HW 5}
\fancyhead[LO,RE]{D. Hellfeld}
\fancyfoot[C]{\thepage\ of \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

% Set up figure/table captions \textbf{}
\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{\small Table}}
%\renewcommand{\thetable}{\Roman{table}}
\captionsetup[table]{labelfont = normal, labelsep=period, singlelinecheck=true}
\captionsetup[figure]{labelfont=normal, labelsep=period, singlelinecheck=true}

% Remove paragraph indent
\setlength\parindent{0pt}


\begin{document}


% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
\begin{centering}
\textbf{\large NE 255 - Homework 5}\\
\vspace{10pt}
University of California, Berkeley\\
Department of Nuclear Engineering\\
\vspace{10pt}
Daniel Hellfeld\\
\href{mailto:dhellfeld@berkeley.edu}{dhellfeld@berkeley.edu}\\
\end{centering}






% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
\vspace{20pt}
\noindent \textbf{Problem 1}\\
With the operator form of the Transport Equations:
%
\begin{equation}
    \textbf{L} \psi = \textbf{MS} \phi + \textbf{M} q_e
\end{equation}
\vspace{-17pt}
\begin{equation}
    \phi = \textbf{D}\psi
\end{equation}

and given the following discretizations:
%
\begin{itemize}
\setlength\itemsep{-3pt}
    \item 3 groups
    \item $P_2$ (number of moments is $(N + 1)^2$)
    \item $S_2$ (number of angles is $N(N + 2)$, with the $N$ being from $S_N$ rather than $P_N$ above)
    \item $4\times4\times4$ mesh
    \item Diamond Difference
\end{itemize}


\begin{enumerate}[(a)]
\item Indicate the dimensions of each matrix in Eq.~(1), using real numbers for what we did generically in class.
\end{enumerate}

...

%
%
%

\vspace{10pt}
\begin{enumerate}[(b)]
\item Write out the matrices $[\textbf{M}]_{gg}$, $\textbf{S}$, and $[\textbf{S}]_{21}$ as well as the vectors $\psi$, $[\psi]_1$, and $[\phi]_1$ to make sure you know what values match with what.
\end{enumerate}

...

%
%
%

\vspace{10pt}
\begin{enumerate}[(c)]
\item Write what the $\textbf{D}$ matrix would be.
\end{enumerate}

...

%
%
%

\vspace{10pt}
\begin{enumerate}[(d)]
\item Why don’t we form an $\textbf{L}$ matrix?
\end{enumerate}

...

%
%
%

\vspace{10pt}
\begin{enumerate}[(e)]
\item Combine Eqs.~(1) and (2) to get a system that looks like $\textbf{A}x = b$, writing out the steps.
\end{enumerate}

...














% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
\newpage
\noindent \textbf{Problem 2}\\
Implement a Jacobi multigroup solver for the 1D, steady state transport equations with isotropic scattering and an isotropic external source. Use the weighted diamond difference solver you wrote for the previous homework to solve the within group equations (if you are unsure if yours worked let me know) (note: you functionally should have written source iteration). Use the following values and three energy groups:
%
\begin{itemize}
\setlength\itemsep{-3pt}
    \item $x_0=0.0,\,\,x_1=2.0,\,\,h=0.1$
    \item $\alpha=0.5$
    \item $\mu_a = \pm[0.2,0.5,0.7]$
    \item $\Sigma_{t,1}=0.5,\,\, \Sigma_{t,2}=0.8,\,\, \Sigma_{t,3}=1.0$
    \item $\Sigma_s^{g' \rightarrow g}$ values are given by Table 1.
    \item $q_{e,1}=1.5,\,\, q_{e,2}=0.0,\,\, q_{e,1}=0.2$
    \item left boundary condition is 0.5 incoming in group 1, zero otherwise
\end{itemize}
%
\begin{table}[htb!]
	\centering
	\setlength{\tabcolsep}{10pt}
	\begin{tabular}{|c|c|c|c|}
		\hline
		\diagbox[width=40pt, height=20pt]{$g'$}{$g$} & 1 & 2 & 3 \\ \hline
		1 & 0.1 & 0.0 & 0.0 \\ 
		2 & 0.3 & 0.1 & 0.1 \\ 
		3 & 0.1 & 0.3 & 0.3 \\ \hline
	\end{tabular}
	\caption{Scattering (from group $g'$ to group $g$) cross-section values.}
\end{table}


Plot the resulting scalar flux in each energy group as a function of $x$. Use a convergence tolerance for the multigroup iteration and the scattering iteration of at least $1 \times 10^{-4}$.\\\\


...






% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

\end{document}
